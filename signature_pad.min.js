!function(a,b){"function"==typeof define&&define.amd?define([],function(){return a.SignaturePad=b()}):"object"==typeof exports?module.exports=b():a.SignaturePad=b()}(this,function(){/*!
 * Signature Pad v1.4.0 | https://github.com/szimek/signature_pad
 * (c) 2015 Szymon Nowak | Released under the MIT license
 */
var a=function(a){"use strict";var b=function(a,b){var c=this,d=b||{};if(this.velocityFilterWeight=d.velocityFilterWeight||.7,this.minWidth=d.minWidth||.5,this.maxWidth=d.maxWidth||2.5,this.cpTension=d.cpTension||.5,this.curveOrder=d.curveOrder||3,this.curveOrder<2||this.curveOrder>4)throw Error("Invalid curveOrder"+this.curveOrder);this.throttle=d.throttle||16,this.dotSize=d.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=d.penColor||"black",this.backgroundColor=d.backgroundColor||"rgba(0,0,0,0)",this.onEnd=d.onEnd,this.onBegin=d.onBegin,this._canvas=a,this._ctx=a.getContext("2d"),this._ctx.lineCap="round",this._ctx.lineJoin="round",this.clear(),this._canvasWidthScale=null,this._canvasHeightScale=null,this._handleMouseDown=function(a){1===a.which&&(c._mouseButtonDown=!0,c._strokeBegin(a))},this._handleMouseMove=function(a){c._mouseButtonDown&&c._strokeUpdate(a)},this._handleMouseUp=function(a){1===a.which&&c._mouseButtonDown&&(c._mouseButtonDown=!1,c._strokeEnd(a))},this._handleTouchStart=function(a){var b=a.changedTouches[0];c._strokeBegin(b)},this._handleTouchMove=function(a){a.preventDefault();var b=a.changedTouches[0];c._strokeUpdate(b)},this._handleTouchEnd=function(a){var b=a.target===c._canvas;b&&c._strokeEnd(a)},this._handleMouseEvents(),this._handleTouchEvents()};b.prototype.clear=function(){var a=this._ctx,b=this._canvas;a.fillStyle=this.backgroundColor,a.clearRect(0,0,b.width,b.height),a.fillRect(0,0,b.width,b.height),this._reset()},b.prototype.toDataURL=function(){var a=this._canvas;return a.toDataURL.apply(a,arguments)},b.prototype.fromDataURL=function(a){var b=this,c=new Image,d=window.devicePixelRatio||1,e=this._canvas.width/d,f=this._canvas.height/d;this._reset(),c.src=a,c.onload=function(){b._ctx.drawImage(c,0,0,e,f)},this._isEmpty=!1},b.prototype._strokeUpdate=function(a){var b=this._createPoint(a);this._addPoint(b)},b.prototype._strokeBegin=function(a){this._reset(),this._strokeUpdate(a),"function"==typeof this.onBegin&&this.onBegin(a)},b.prototype._strokeDraw=function(a){var b=this._ctx,c="function"==typeof this.dotSize?this.dotSize():this.dotSize;b.beginPath(),this._drawPoint(a.x,a.y,c),b.closePath(),b.fill()},b.prototype._strokeEnd=function(a){var b=this.points.length>2,c=this.points[0];!b&&c&&this._strokeDraw(c),"function"==typeof this.onEnd&&this.onEnd(a)},b.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),a.addEventListener("mouseup",this._handleMouseUp)},b.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),a.addEventListener("touchend",this._handleTouchEnd)},b.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),a.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),a.removeEventListener("touchend",this._handleTouchEnd)},b.prototype.isEmpty=function(){return this._isEmpty},b.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._isEmpty=!0,this._ctx.fillStyle=this.penColor,this._ctx.strokeStyle=this.penColor},b.prototype._getCanvasWidthScale=function(){return this._canvasWidthScale||(this._canvasWidthScale=this._canvas.clientWidth/this._canvas.width),this._canvasWidthScale},b.prototype._getCanvasHeightScale=function(){return this._canvasHeightScale||(this._canvasHeightScale=this._canvas.clientHeight/this._canvas.height),this._canvasHeightScale},b.prototype._createPoint=function(a){var b=this._canvas.getBoundingClientRect();return new c((a.clientX-b.left)/this._getCanvasWidthScale(),(a.clientY-b.top)/this._getCanvasHeightScale())},b.prototype._throttle=function(a){var b=this.points[this.points.length-1];return b&&b.sqrDistanceTo(a)<this.throttle?!1:!0},b.prototype._addPoint=function(a){var b,e,f,g,h=this.points;if(this._throttle(a)){for(h.push(a);h.length<this.curveOrder;)h.unshift(h[0]);2===this.curveOrder?f=new d(h[0],void 0,void 0,h[1]):3===this.curveOrder?(b=new c((h[0].x+h[1].x)/2,(h[0].y+h[1].y)/2),e=new c((h[1].x+h[2].x)/2,(h[1].y+h[2].y)/2),f=new d(b,h[1],void 0,e)):4===this.curveOrder&&(g=this._calculateCurveControlPoints(h[0],h[1],h[2]),b=g.c2,g=this._calculateCurveControlPoints(h[1],h[2],h[3]),e=g.c1,f=new d(h[1],b,e,h[2])),this._addCurve(f),h.shift()}},b.prototype._calculateCurveControlPoints=function(a,b,d){var e=.5,f=a.distanceTo(b),g=b.distanceTo(d),h=e*f/(f+g),i=e*g/(f+g);return{c1:new c(b.x-h*(d.x-a.x),b.y-h*(d.y-a.y)),c2:new c(b.x+i*(d.x-a.x),b.y+i*(d.y-a.y))}},b.prototype._addCurve=function(a){var b,c,d=a.startPoint,e=a.endPoint;this.maxWidth!==this.minWidth?(b=e.velocityFrom(d),b=this.velocityFilterWeight*b+(1-this.velocityFilterWeight)*this._lastVelocity,c=this._strokeWidth(b),this._drawCurve(a,this._lastWidth,c),this._lastVelocity=b,this._lastWidth=c):this._drawCurve(a,this._lastWidth,this._lastWidth)},b.prototype._drawPoint=function(a,b,c){var d=this._ctx;d.moveTo(a,b),d.arc(a,b,c/2,0,2*Math.PI,!1),this._isEmpty=!1},b.prototype._drawCurve=function(a,b,c){var d=this._ctx;d.beginPath(),d.moveTo(a.startPoint.x,a.startPoint.y),a.control1&&a.control2?d.bezierCurveTo(a.control1.x,a.control1.y,a.control2.x,a.control2.y,a.endPoint.x,a.endPoint.y):a.control1?d.quadraticCurveTo(a.control1.x,a.control1.y,a.endPoint.x,a.endPoint.y):d.lineTo(a.endPoint.x,a.endPoint.y),d.lineWidth=c,d.stroke()},b.prototype._strokeWidth=function(a){return Math.max(this.maxWidth/(a+1),this.minWidth)};var c=function(a,b,c){this.x=a,this.y=b,this.time=c||(new Date).getTime()};c.prototype.velocityFrom=function(a){return this.time!==a.time?this.distanceTo(a)/(this.time-a.time):1},c.prototype.distanceTo=function(a){return Math.sqrt(this.sqrDistanceTo(a))},c.prototype.sqrDistanceTo=function(a){return Math.pow(this.x-a.x,2)+Math.pow(this.y-a.y,2)};var d=function(a,b,c,d){this.startPoint=a,this.control1=b,this.control2=c,this.endPoint=d};return b}(document);return a});